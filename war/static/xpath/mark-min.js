var host=document.location.host;if(host.indexOf("newcrawler.com")!=-1){host="www.newcrawler.com";newcrawler_server_url="http://"+host+"/"}var ncx_traceHighlight={isallowtrace:1,isHighlight:0,element:null,highlight:function(i,h,g,l,k,j){i.css({left:h,top:g,width:l,height:k}),i.css({"z-index":99999,position:"absolute","background-color":"#facd93"});i.css(j,"1px dashed #000")},process:function(k){var l=k.target||k.srcElement;if(jQuery(l).get(0).tagName.toLowerCase()!="html"&&jQuery(l).attr("class")!="ncx_highlightTool"&&ncx_traceHighlight.isallowtrace==1){ncx_traceHighlight.isHighlight=1;ncx_traceHighlight.element=l;jQuery(".ncx_highlightTool").remove();jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_top' class='ncx_highlightTool'></div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_right' class='ncx_highlightTool'></div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_bottom' class='ncx_highlightTool'></div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_left' class='ncx_highlightTool'></div>");var q=jQuery("#ncx_traceHighlight_top");var m=jQuery("#ncx_traceHighlight_right");var n=jQuery("#ncx_traceHighlight_bottom");var p=jQuery("#ncx_traceHighlight_left");var j=jQuery(l).offset();var e=jQuery(l).outerWidth();var o=jQuery(document).width();if(e>o){e=o-8}this.highlight(q,j.left-2,j.top-2,e+4,2,"border-bottom");this.highlight(m,j.left+e,j.top,2,jQuery(l).outerHeight(),"border-left");this.highlight(n,j.left-2,j.top+jQuery(l).outerHeight(),e+4,2,"border-top");this.highlight(p,j.left-2,j.top,2,jQuery(l).outerHeight(),"border-right")}}};var ncx_innerFun={highlightIndex:0,isNullOrEmpty:function(b){return(null==b||"null"==b||""==b||undefined==b||"undefined"==b||[]==b||undefined==jQuery(b).get(0).tagName)},innerRemove:function(b){jQuery(b).remove();return false},innerAppend:function(d,c){jQuery(d).append(c)},outerAppend:function(d,c){jQuery(d).after(c)},highlight:function(i,h,g,l,k,j){i.css({left:h,top:g,width:l,height:k});i.css({"z-index":99999,position:"absolute","background-color":"#facd93"});i.css(j,"1px dashed #000")},highlightCover:function(h,g,f,j,i){h.css({left:g,top:f,width:j,height:i});h.css({"z-index":99999,position:"absolute","background-color":"#000",opacity:0.5})},addHighlight:function(k,o,j){ncx_innerFun.highlightIndex=ncx_innerFun.highlightIndex+1;var e="";if(o){e="<div class='ncx_selector'><a class='ncx-highlight-button ncx-accept-highlight' lang='"+j+"'></a><a class='ncx-highlight-button ncx-reject-highlight' lang='"+j+"'></a></div>"}jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_top_"+ncx_innerFun.highlightIndex+"' class='ncx_highlightTool'></div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_right_"+ncx_innerFun.highlightIndex+"' class='ncx_highlightTool'>"+e+"</div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_bottom_"+ncx_innerFun.highlightIndex+"' class='ncx_highlightTool'></div>");jQuery("#ncx_curlCover").append("<div id='ncx_traceHighlight_left_"+ncx_innerFun.highlightIndex+"' class='ncx_highlightTool'></div>");var q=jQuery("#ncx_traceHighlight_top_"+ncx_innerFun.highlightIndex+"");var l=jQuery("#ncx_traceHighlight_right_"+ncx_innerFun.highlightIndex+"");var m=jQuery("#ncx_traceHighlight_bottom_"+ncx_innerFun.highlightIndex+"");var p=jQuery("#ncx_traceHighlight_left_"+ncx_innerFun.highlightIndex+"");var j=jQuery(k).offset();var h=jQuery(k).outerWidth();var r=jQuery(k).outerHeight();var n=jQuery(document).width();if(h>n){h=n-8}this.highlight(q,j.left-2,j.top-2,h+4,2,"border-bottom");this.highlight(l,j.left+h,j.top,2,r,"border-left");this.highlight(m,j.left-2,j.top+r,h+4,2,"border-top");this.highlight(p,j.left-2,j.top,2,r,"border-right")},innerHighlightRender:function(B){jQuery(".ncx_highlightTool").remove();var v=jQuery(B).offset().top;var o=jQuery(B).offset().left;var F=jQuery(B).outerWidth();var r=jQuery(B).outerHeight();var t=jQuery(document.body).outerHeight();var u=jQuery(document.body).outerWidth();if(F>u+8){F=u}ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_highlightCover_top' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_highlightCover_right' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_highlightCover_bottom' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_highlightCover_left' class='ncx_highlightTool'></div>");var E=jQuery("#ncx_highlightCover_top");var x=jQuery("#ncx_highlightCover_right");var z=jQuery("#ncx_highlightCover_bottom");var D=jQuery("#ncx_highlightCover_left");this.highlightCover(E,0,0,u+8,v-3);this.highlightCover(x,o+3+F,v-3,u-o-3-F+8,r+6);this.highlightCover(z,0,v+3+r,u+8,t-v-r+5+150);this.highlightCover(D,0,v-3,o-3,r+6);ncx_traceHighlight.isallowtrace=0;ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_editHighlight_top' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_editHighlight_right' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_editHighlight_bottom' class='ncx_highlightTool'></div>");ncx_innerFun.innerAppend("#ncx_curlCover","<div id='ncx_editHighlight_left' class='ncx_highlightTool'></div>");var w=jQuery("#ncx_editHighlight_top");var s=jQuery("#ncx_editHighlight_right");var A=jQuery("#ncx_editHighlight_bottom");var C=jQuery("#ncx_editHighlight_left");var y=jQuery(B).offset();this.highlight(w,y.left-2,y.top-2,F+4,2,"border-bottom");this.highlight(s,y.left+F,y.top,2,jQuery(B).outerHeight(),"border-left");this.highlight(A,y.left-2,y.top+jQuery(B).outerHeight(),F+4,2,"border-top");this.highlight(C,y.left-2,y.top,2,jQuery(B).outerHeight(),"border-right");jQuery(".ncx_highlightTool").click(function(){ncx_innerFun.closeCover()})},closeCover:function(){jQuery(".ncx_highlightTool").remove();jQuery("#ncx_edit_tpl_tool").remove();ncx_traceHighlight.isallowtrace=1;jQuery("#ncx_curlCover").css({"pointer-events":"none"});if(newcrawler.ispage==false){jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text("0")}},clickSelect:function(c){ncx_et_tool.targetIndex=0;var d=c.target||c.srcElement;if(ncx_traceHighlight.isHighlight==1){var a=ncx_traceHighlight.element;if(jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-pagination")){newcrawler.ispage=true}else{newcrawler.ispage=false}ncx_et_tool.readXPath(a);jQuery("#ncx_curlCover").css({"pointer-events":"auto"});ncx_innerFun.selectHighlight(a,1)}},selectHighlight:function(E,d){if(newcrawler.ispage){ncx_et_tool.xpathArray=null;for(var A=ncx_et_tool.xpathArray2.length,y=A-1;y>0;y--){if(ncx_et_tool.xpathArray2[y]=="a"||ncx_et_tool.xpathArray2[y].indexOf("a[")==0){var f=Array();for(var A=y,x=0;x<=A;x++){f[x]=ncx_et_tool.xpathArray2[x]}var v=f.join("");var r=document.evaluate(v,document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var h=r.snapshotItem(0);E=h;ncx_et_tool.xpathArray2=f.slice(0);ncx_et_tool.xpathArray=f.slice(0);break}}if(ncx_et_tool.xpathArray==null){ncx_innerFun.closeCover();return}}jQuery(".ncx_highlightTool").remove();var g=null;var z=0;if(!newcrawler.ispage){if(newcrawler.fieldArray.length>1){g=newcrawler.fieldArray[1].xpathArray;for(var y=1,A=newcrawler.fieldArray.length;y<A;y++){for(var x=0,q=newcrawler.fieldArray[y].xpathArray.length;x<q;x++){if(newcrawler.fieldArray[y].xpathArray[x].indexOf("[*]")!=-1){g=newcrawler.fieldArray[y].xpathArray}}}z=g.length}}var k=0;for(var y=0,A=ncx_et_tool.xpathArray.length;y<A;y++){if(ncx_et_tool.xpathArray[y].indexOf("[*]")!=-1){if(g!=null){if(z>y){if(g[y].indexOf("[*]")==-1){ncx_et_tool.xpathArray[y]=ncx_et_tool.xpathArray2[y];continue}}else{ncx_et_tool.xpathArray[y]=ncx_et_tool.xpathArray2[y];continue}}k++}}var m=false;if(k>1){m=true;jQuery("#ncx_edit_tpl_tool").remove();ncx_traceHighlight.isallowtrace=1;d=1}else{ncx_innerFun.innerHighlightRender(E);if(d===1){ncx_et_tool.add_et(E)}else{ncx_et_tool.change_et(E)}var u=ncx_et_tool.xpathArray.join("");jQuery("#ncx_copy_xpath_text").text(u);var B=ncx_et_tool.readCssPath(jQuery(ncx_et_tool.targetNow).get(0));jQuery("#ncx_copy_csspath_text").text(B);var w=jQuery(E).get(0);jQuery("select[name='ncx_attr']").empty();jQuery("select[name='ncx_attr']").append('<option value=""></option>');var l=false;for(var y=0,t=w.attributes,s=t.length;y<s;y++){var G=t[y].nodeName.toLowerCase();if(G=="class"||G=="style"||G=="target"||G=="width"||G=="height"||G.indexOf("on")==0){continue}jQuery("select[name='ncx_attr']").append('<option value="'+G+'">'+G+"</option>");l=true}if(l){jQuery("select[name='ncx_attr'] option:nth-child(2)").attr("selected",true);jQuery("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",false);jQuery("select[name='ncx_attr']").attr("disabled",false)}else{jQuery("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",true);jQuery("select[name='ncx_attr']").attr("disabled",true)}if((w.tagName.toLowerCase()=="img"||w.tagName.toLowerCase()=="a")&&l){jQuery("input[name='ncx_selectType'][value='@ATTR']").attr("checked",true);jQuery("select[name='ncx_attr']").change()}else{var c=w.innerHTML;jQuery("#ncx_content_preview").text(c)}}k=0;var p=[];for(var y=0,A=ncx_et_tool.xpathArray.length;y<A;y++){p[y]=ncx_et_tool.xpathArray[y];if(p[y].indexOf("[*]")!=-1){for(var x=y+1;x<A;x++){p[x]=ncx_et_tool.xpathArray2[x]}var F=p.join("");var o=document.evaluate(F,document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var D=o.snapshotLength;k=k+D;for(var C=0;C<D;C++){var a=o.snapshotItem(C);if(p[p.length-1].indexOf("@")==0){a=a.ownerElement}if(ncx_et_tool.isSame(E,a)){ncx_innerFun.addHighlight(a,false,y)}else{ncx_innerFun.addHighlight(a,m,y)}}p[y]=ncx_et_tool.xpathArray2[y]}}if(k==0){k++}if(!newcrawler.ispage){jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text(k)}jQuery(".ncx-accept-highlight").unbind("click").click(function(){var j=jQuery(this).attr("lang");for(var e=0,b=ncx_et_tool.xpathArray.length;e<b;e++){if(ncx_et_tool.xpathArray[e].indexOf("[*]")!=-1&&j!=e){ncx_et_tool.xpathArray[e]=ncx_et_tool.xpathArray2[e]}}ncx_innerFun.selectHighlight(E,d)});jQuery(".ncx-reject-highlight").unbind("click").click(function(){var j=jQuery(this).attr("lang");for(var e=0,b=ncx_et_tool.xpathArray.length;e<b;e++){if(ncx_et_tool.xpathArray[e].indexOf("[*]")!=-1&&j==e){ncx_et_tool.xpathArray[e]=ncx_et_tool.xpathArray2[e]}}ncx_innerFun.selectHighlight(E,d)})}};var ncx_et_tool={targetIndex:0,targetArray:Array(),targetNow:Object(),targetDataNow:Object(),stateChange:0,xpathArray:Array(),csspathArray:Array(),xpathArray2:Array(),csspathArray2:Array(),getTargetArray:function(d){ncx_et_tool.targetArray.push(d);var f=jQuery(d).parent();var e=f.get(0);if(ncx_innerFun.isNullOrEmpty(e)){return ncx_et_tool.targetArray}return ncx_et_tool.getTargetArray(f)},add_et:function(c){ncx_et_tool.targetDataNow=Object();ncx_et_tool.targetNow=c;ncx_et_tool.stateChange=0;jQuery("#ncx_edit_tpl_tool").remove();var d=this.getcode("et_wrap");ncx_innerFun.innerAppend("#ncx_cover-container",d);this.install("ncx_et_state_10");ncx_et_tool.init(c);ncx_et_tool.alterInstall(c);ncx_et_tool.targetArray=Array();ncx_et_tool.getTargetArray(c);jQuery("#ncx_edit_tpl_tool").removeData("child");jQuery("#ncx_edit_tpl_tool").data("child",ncx_et_tool.targetArray)},change_et:function(b){ncx_et_tool.targetNow=b;ncx_et_tool.init(b);var d=jQuery(ncx_et_tool.targetNow).get(0);var c=d.innerHTML;jQuery("#ncx_content_preview").text(c);jQuery("#ncx_copy_xpath_tips").text("");jQuery("#ncx_copy_xpath_text").css({"background-color":"white"});jQuery("#ncx_copy_csspath_tips").text("");jQuery("#ncx_copy_csspath_text").css({"background-color":"white"})},init:function(m){var p=jQuery(m).offset().top;var q=jQuery(m).offset().left;var j=jQuery(m).outerWidth();var o=jQuery(m).outerHeight();var k=jQuery(document.body).outerHeight();var l=jQuery(document.body).outerWidth();if(k-p-o<65){var r=q+j-400;var n=p+1;if(r<=0){r=0}if(r>l){r=l-8}if(n<0){n=0}jQuery("#ncx_edit_tpl_tool").css({left:r+"px",top:n+"px"})}else{var r=q+j-397;var n=p+o+3;if(r<=0){r=0}if(r>l){r=l-499}jQuery("#ncx_edit_tpl_tool").css({left:r+"px",top:n+"px"})}jQuery(window).scrollTop(n-300);jQuery(window).scrollLeft(r-200)},getcode:function(c){var d="";switch(c){case"et_wrap":d="<div class='ncx_edit_tpl_tool' style='position : absolute; z-index : 999990;' id='ncx_edit_tpl_tool'><ul id='ncx_et_bar' class='ncx_et_bar'>";d+="<li class='ncx_col1'><div id='ncx_larger' class='ncx_larger'></div><div id='ncx_smaller' class='ncx_smaller'></div></li>";d+="<li class='ncx_col4' id='ncx_et_state_4'><span class='ncx_bar_button_tilte'>Preview</span></li>";d+="</ul><div id='ncx_et_content' class='ncx_et_content'></div><div id='ncx_et_content_footer' class='ncx_et_content_footer'></div></div>";break;case"et_conetent_inner_20":d="<div class='ncx_et_content_inner' id='ncx_copy_xpath_container' style='position:relative'>";d+="<pre id='ncx_copy_xpath_text' class='ncx_xpath'>xpath express test!!!</pre>";d+="<div class='ncx_button'><button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy XPath</button><button class='ncx_et_cancel'></button></div>";d+="<div id='ncx_copy_xpath_tips' class='ncx_tips'></div>";d+="</div>";break;case"et_conetent_inner_30":d="<div class='ncx_et_content_inner' id='ncx_copy_csspath_container' style='position:relative'>";d+="<pre id='ncx_copy_csspath_text' class='ncx_csspath'>csspath express test!!!</pre>";d+="<div class='ncx_button'><button id='ncx_copy_csspath_button' class='ncx_csspath_copy'>Copy CssPath</button><button class='ncx_et_cancel'></button></div>";d+="<div id='ncx_copy_csspath_tips' class='ncx_tips'></div>";d+="</div>";break;case"et_conetent_inner_40":d="<div class='ncx_et_content_inner'>";d+="<div><div class='nc_label'>XPath</div><pre id='ncx_copy_xpath_text' class='ncx_xpath ncx_expression'>xpath express test!!!</pre></div>";d+="<div style='height: 22px;'>";d+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='outerHTML' style='vertical-align: middle;'><span>outerHTML</span></div>";d+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerHTML' style='vertical-align: middle;' checked='checked' ><span>innerHTML</span></div>";d+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerTEXT' style='vertical-align: middle;'><span>innerTEXT</span></div>";d+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='@ATTR' style='vertical-align: middle;display:none;'><span><select name='ncx_attr'></select></span></div>";d+="</div>";d+="<div><pre id='ncx_content_preview' class='ncx_content'></pre></div>";d+="<div class='ncx_button'>";d+="<button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy XPath</button>";d+="<button class='ncx_et_cancel'></button>";d+="<button class='ncx_et_create'></button>";d+="</div>";d+="<div class='ncx_tips'></div></div>";break}return d},installCopy:function(){var a=new ZeroClipboard(document.getElementById("ncx_copy_csspath_button"));a.on("ready",function(c){a.on("copy",function(d){d.clipboardData.setData("text/plain",jQuery("#ncx_copy_csspath_text").text())});a.on("aftercopy",function(d){jQuery(".ncx_tips").text("Copied CssPath.");jQuery(".ncx_expression").css({"background-color":"white"});jQuery("#ncx_copy_csspath_text").css({"background-color":"rgb(236, 248, 233)"})})});var b=new ZeroClipboard(document.getElementById("ncx_copy_xpath_button"));b.on("ready",function(c){b.on("copy",function(d){d.clipboardData.setData("text/plain",jQuery("#ncx_copy_xpath_text").text())});b.on("aftercopy",function(d){jQuery(".ncx_tips").text("Copied XPath.");jQuery(".ncx_expression").css({"background-color":"white"});jQuery("#ncx_copy_xpath_text").css({"background-color":"rgb(236, 248, 233)"})})})},install:function(c){jQuery("#ncx_et_bar").removeClass("ncx_shape1");jQuery(".ncx_bar_button_tilte").removeClass("ncx_on");jQuery("#ncx_et_content").removeClass("ncx_shape1");jQuery("#ncx_et_content_footer").removeClass("ncx_shape1");jQuery("#ncx_et_content").empty();switch(c){case"ncx_et_state_10":jQuery("#ncx_et_bar").addClass("ncx_shape1");break;case"ncx_et_state_20":jQuery("#ncx_et_bar").addClass("ncx_shape1");jQuery(".ncx_col2 > .ncx_bar_button_tilte").addClass("ncx_on");jQuery("#ncx_et_content").addClass("ncx_shape1");jQuery("#ncx_et_content_footer").addClass("ncx_shape1");var d=this.getcode("et_conetent_inner_20");ncx_innerFun.innerAppend("#ncx_et_content",d);var e=this.readXPath(jQuery(ncx_et_tool.targetNow).get(0));jQuery("#ncx_copy_xpath_text").text(e);this.installCopy();break;case"ncx_et_state_30":jQuery("#ncx_et_bar").addClass("ncx_shape1");jQuery(".ncx_col3 > .ncx_bar_button_tilte").addClass("ncx_on");jQuery("#ncx_et_content").addClass("ncx_shape1");jQuery("#ncx_et_content_footer").addClass("ncx_shape1");var d=this.getcode("et_conetent_inner_30");ncx_innerFun.innerAppend("#ncx_et_content",d);var h=this.readCssPath(jQuery(ncx_et_tool.targetNow).get(0));jQuery("#ncx_copy_csspath_text").text(h);this.installCopy();break;case"ncx_et_state_40":jQuery("#ncx_et_bar").addClass("ncx_shape1");jQuery(".ncx_col4 > .ncx_bar_button_tilte").addClass("ncx_on");jQuery("#ncx_et_content").addClass("ncx_shape1");jQuery("#ncx_et_content_footer").addClass("ncx_shape1");var d=this.getcode("et_conetent_inner_40");ncx_innerFun.innerAppend("#ncx_et_content",d);var g=jQuery(ncx_et_tool.targetNow).get(0);var f=g.innerHTML;jQuery("select[name='ncx_attr']").unbind("change").change(function(){jQuery("input[name=ncx_selectType][value='@ATTR']").attr("checked",true);if(this.value==""){jQuery("input[name=ncx_selectType][value='outerHTML']").attr("checked",true);jQuery("input[name=ncx_selectType][value='outerHTML']").click();return}var i=ncx_et_tool.xpathArray.length;if(ncx_et_tool.xpathArray[i-1].indexOf("@")==0){ncx_et_tool.xpathArray.splice(-2,2);ncx_et_tool.xpathArray2.splice(-2,2);var k=ncx_et_tool.xpathArray.join("");jQuery("#ncx_copy_xpath_text").text(k)}var b=jQuery("select[name='ncx_attr']").val();ncx_et_tool.xpathArray.push("/");ncx_et_tool.xpathArray.push("@"+b);ncx_et_tool.xpathArray2.push("/");ncx_et_tool.xpathArray2.push("@"+b);var k=ncx_et_tool.xpathArray.join("");jQuery("#ncx_copy_xpath_text").text(k);jQuery("#ncx_content_preview").text("");var a=ncx_et_tool.xpathArray2.join("");var l=document.evaluate(a,document,null,XPathResult.ANY_TYPE,null);if(l){var j=l.iterateNext();jQuery("#ncx_content_preview").text(j.textContent)}});jQuery("input[name=ncx_selectType]").unbind("click").click(function(){var a=ncx_et_tool.xpathArray.length;if(ncx_et_tool.xpathArray[a-1].indexOf("@")==0){ncx_et_tool.xpathArray.splice(-2,2);ncx_et_tool.xpathArray2.splice(-2,2);var i=ncx_et_tool.xpathArray.join("");jQuery("#ncx_copy_xpath_text").text(i)}jQuery("select[name='ncx_attr'][value='']").attr("checked",true);var b=jQuery(this).val();switch(b){case"outerHTML":var k=jQuery(ncx_et_tool.targetNow).get(0);var j=k.outerHTML;jQuery("#ncx_content_preview").text(j);break;case"innerHTML":var k=jQuery(ncx_et_tool.targetNow).get(0);var j=k.innerHTML;jQuery("#ncx_content_preview").text(j);break;case"innerTEXT":jQuery("#ncx_content_preview").text(jQuery(ncx_et_tool.targetNow).text());break}});this.installCopy();break}jQuery(".ncx_et_cancel").click(function(){ncx_innerFun.closeCover()});jQuery(".ncx_et_create").click(function(){var j=ncx_et_tool.xpathArray.join("");var l=newcrawler.index;var b=jQuery("input[name=ncx_selectType]:checked").val();var k="property";if(newcrawler.ispage){l=0;k="property"+l}else{for(var p=l;p<500;p++){k="property"+p;var o=false;for(var m=1,a=newcrawler.fieldArray.length;m<a;m++){if(k==newcrawler.fieldArray[m].name){o=true;break}}if(!o){break}}}ncx_et_tool.createLabel(null,l,k,j,ncx_et_tool.xpathArray,b,newcrawler.ispage);ncx_innerFun.closeCover()})},createLabel:function(c,f,b,g,e,i,j){if(j){newcrawler.fieldArray[0]={id:c,index:0,name:b,xpath:g,xpathArray:e,selectType:i}}else{var a=document.evaluate(g,document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var h=a.snapshotLength;jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text(h);var d=jQuery("#ncx_toolbar .ncx-datatypes .active");d.addClass("ncx-blue finished");d.removeClass("ncx-yellow");d.removeClass("active");newcrawler.fieldArray.push({id:c,index:f,name:b,xpath:g,xpathArray:e,selectType:i});newcrawler.index=newcrawler.index+1;jQuery('<a lang="'+newcrawler.index+'" class="ncx-label ncx-data-dot ncx-yellow active"><span class="ncx-count">0</span><span class="ncx-delete-datatype" style="display: none;"></span></a>').insertBefore("#ncx_toolbar .ncx-datatypes .ncx-pagination")}jQuery("#ncx_toolbar .save").attr("disabled",false);newcrawler.toolbarEvent()},larger:function(){var c=jQuery("#ncx_edit_tpl_tool").data("child");if(ncx_et_tool.targetIndex<c.length){ncx_et_tool.targetIndex++}var d=c[ncx_et_tool.targetIndex];if(!ncx_innerFun.isNullOrEmpty(d)){ncx_et_tool.readXPath(jQuery(d).get(0));ncx_innerFun.selectHighlight(jQuery(d).get(0),2)}},smaller:function(){var c=jQuery("#ncx_edit_tpl_tool").data("child");if(ncx_et_tool.targetIndex>0){ncx_et_tool.targetIndex--}var d=c[ncx_et_tool.targetIndex];if(!ncx_innerFun.isNullOrEmpty(d)){ncx_et_tool.readXPath(jQuery(d).get(0));ncx_innerFun.selectHighlight(jQuery(d).get(0),2)}},readXPath:function(c){var m=c;ncx_et_tool.xpathArray=[];ncx_et_tool.xpathArray2=[];for(;c&&c.tagName!==undefined;c=c.parentNode){var d=c.tagName;if(!d){break}d=d.toLowerCase();if(c.id=="ncx_cover-container"||c.id=="ncx_message-box"){continue}var e=jQuery(c).parent();var a=e.children(d).not("#ncx_message-box").not("#ncx_cover-container");var p=a.length;var b="";var g="";if(p>1){for(var h=0;h<p;h++){var u=a[h];if(this.isSame(c,u)){if(b==""){b="["+(h+1)+"]"}g="["+(h+1)+"]";continue}if(b!="[*]"&&ncx_et_tool.xpathArray.length>0){var r="./"+ncx_et_tool.xpathArray2.join("");var f=document.evaluate(r,u,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var t=f.snapshotLength;if(t>0){if(t>0){b="[*]";continue}}}}}if(b!="[*]"){if(c.id&&!/\s/.test(c.id)){var n=true;if(newcrawler.ispage){n=false;for(var i=0,j=ncx_et_tool.xpathArray.length;i<j;i++){if(ncx_et_tool.xpathArray[i]=="a"||ncx_et_tool.xpathArray[i].indexOf("a[")==0){n=true;break}}}if(n){var q=ncx_et_tool.xpathArray.slice(0);for(var l=0,k=q.length;l<k;l++){if(q[l].indexOf("[*]")!=-1){q[l]=ncx_et_tool.xpathArray2[l]}}var o='//*[@id="'+c.id+'"]';q.unshift(o);var s=q.join("");nodesSnapshot=document.evaluate(s,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(nodesSnapshot.snapshotLength<=1){ncx_et_tool.xpathArray.unshift(o);ncx_et_tool.xpathArray2.unshift(o);break}}}}else{if(b==""){b="[1]";g="[1]"}}if(d=="html"||d=="body"){b="";g=""}b=d+b;g=d+g;ncx_et_tool.xpathArray.unshift(b);ncx_et_tool.xpathArray.unshift("/");ncx_et_tool.xpathArray2.unshift(g);ncx_et_tool.xpathArray2.unshift("/")}return ncx_et_tool.xpathArray.join("")},isSame:function(b,a){if(b==undefined||a==undefined){return false}var c=b.compareDocumentPosition(a);if(c==0){return true}return false},readCssPath:function(e){ncx_et_tool.csspathArray=[];for(;e&&e.tagName!==undefined;e=e.parentNode){var d=e.tagName;if(!d){break}d=d.toLowerCase();if(e.id=="ncx_cover-container"||e.id=="ncx_message-box"){continue}if(e.id&&!/\s/.test(e.id)){ncx_et_tool.csspathArray.unshift(e.id);ncx_et_tool.csspathArray.unshift("#")}else{var f=jQuery(e).parent();var h=f.children(d);if(h.length>1){var g=f.children();var b=g.index(e)+1;if(b>0){d+=":nth-child("+b+")"}}ncx_et_tool.csspathArray.unshift(d);ncx_et_tool.csspathArray.unshift(">");continue}ncx_et_tool.csspathArray.unshift(d);ncx_et_tool.csspathArray.unshift(">");var c=ncx_et_tool.csspathArray.slice(1).join("");var a=jQuery(c).length;if(a<=1){break}}return ncx_et_tool.csspathArray.slice(1).join("")},alterInstall:function(){jQuery("#ncx_larger").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#ncx_smaller").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#ncx_larger").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery("#ncx_smaller").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery(".ncx_bar_button_tilte").mouseover(function(){jQuery(this).addClass("ncx_onhover")});jQuery(".ncx_bar_button_tilte").mouseout(function(){jQuery(this).removeClass("ncx_onhover")});jQuery("#ncx_larger").click(function(){ncx_et_tool.larger()});jQuery("#ncx_smaller").click(function(){ncx_et_tool.smaller()});jQuery("#ncx_et_state_2").click(function(){ncx_et_tool.install("ncx_et_state_20")});jQuery("#ncx_et_state_3").click(function(){ncx_et_tool.install("ncx_et_state_30")});jQuery("#ncx_et_state_4").click(function(){ncx_et_tool.install("ncx_et_state_40")});jQuery("#ncx_et_state_4").trigger("click")}};String.prototype.replaceAll=function(c,d){return this.replace(new RegExp(c,"gm"),d)};var newcrawler={index:1,ispage:false,fieldArray:Array(),allowScale:1,cover:'<div id="ncx_cover-container"><div id="ncx_curlCover" class="ncx_curlCover"  style="z-index : 99999; filter:Alpha(Opacity=100); -moz-opacity: 1; opacity: 1;  pointer-events:none; text-align: left; background : transparent;   "></div></div>',after:function(){jQuery(document).find("*").unbind();jQuery(document.body).append(newcrawler.cover);jQuery(document.body).css({cursor:"pointer"});var e=jQuery(document).height();var g=jQuery(document).width();if(g<600){g=980}var f=g+8;var h=e+8;jQuery("#ncx_curlCover").css({width:g,height:e+8})},event:function(){jQuery(document.body).contents().find("*").not(".ncx_curlCover").not(".ncx_highlightTool").mouseover(function(a){a=a||window.event;ncx_traceHighlight.process(a);return false});jQuery("a").unbind("click").click(function(){return false});jQuery(document.body).contents().find("*").not(".ncx_curlCover").not(".ncx_highlightTool").each(function(){jQuery(this).click(function(a){a=a||window.event;ncx_innerFun.clickSelect(a);return false})});jQuery(document).keydown(function(a){if(a.keyCode==109||a.keyCode==83){ncx_et_tool.smaller()}else{if(a.keyCode==107||a.keyCode==65){ncx_et_tool.larger()}}return false})},toolbarEvent:function(){jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot .ncx-delete-datatype").click(function(){var e=jQuery(this).parent().attr("lang");var d=Array();d.push(newcrawler.fieldArray[0]);for(var c=1,a=newcrawler.fieldArray.length;c<a;c++){var b=newcrawler.fieldArray[c].index;if(e==b){continue}d.push(newcrawler.fieldArray[c])}newcrawler.fieldArray=d;jQuery(this).parent().remove();if(jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished")==undefined){jQuery("#ncx_toolbar .save").attr("disabled",true)}});jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished").mouseout(function(){jQuery(this).find(".ncx-delete-datatype").hide();jQuery(this).find(".ncx-delete-datatype").removeClass("visible")});jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("click").click(function(){if(jQuery(this).hasClass("ncx-pagination")){var s=jQuery(this).hasClass("active");if(!s){jQuery(this).addClass("active");jQuery("#ncx_toolbar .ncx-datatypes .ncx-yellow").each(function(){jQuery(this).removeClass("active")})}}else{if(jQuery(this).hasClass("ncx-label")&&!(jQuery(this).hasClass("finished"))){var s=jQuery(this).hasClass("active");if(!s){jQuery(this).addClass("active");jQuery("#ncx_toolbar .ncx-datatypes .ncx-pagination").removeClass("active")}}}var b=jQuery(this).attr("lang");for(var g in newcrawler.fieldArray){var k=newcrawler.fieldArray[g].index;if(b==k){var l=newcrawler.fieldArray[g].xpath;var t=newcrawler.fieldArray[g].xpathArray.slice(0);var m=t.length;if(t[m-1].indexOf("@")==0){t.splice(-2,2);l=t.join("")}var a=document.evaluate(l,document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var p=a.snapshotLength;for(var r=0;r<p;r++){var f=a.snapshotItem(r);if(r==0){var q=jQuery(f).offset().top;var o=jQuery(f).outerHeight();var j=jQuery(document.body).outerHeight();var n=0;if(j-q-o<65){n=q+1;if(n<0){n=0}}else{n=q+o+3}jQuery(window).scrollTop(n-300)}}}}});jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("mouseover");jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").mouseover(function(){if(jQuery(this).hasClass("ncx-label")&&jQuery(this).hasClass("finished")){jQuery(this).find(".ncx-delete-datatype").show();jQuery(this).find(".ncx-delete-datatype").addClass("visible")}ncx_innerFun.closeCover();var b=jQuery(this).attr("lang");for(var d in newcrawler.fieldArray){var e=newcrawler.fieldArray[d].index;if(b==e){var f=newcrawler.fieldArray[d].xpath;var k=newcrawler.fieldArray[d].xpathArray.slice(0);var g=k.length;if(k[g-1].indexOf("@")==0){k.splice(-2,2);f=k.join("")}var a=document.evaluate(f,document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var h=a.snapshotLength;for(var j=0;j<h;j++){var c=a.snapshotItem(j);ncx_innerFun.addHighlight(c,false,0)}}}})},getUrlParameter:function(a){var d=window.location.search.substring(1);var c=d.split("&");for(var b=0;b<c.length;b++){var e=c[b].split("=");if(e[0]==a){return e[1]}}},loadToolbar:function(){var d=newcrawler.getUrlParameter("webCrawlerId");var e=newcrawler.getUrlParameter("siteId");var b=newcrawler.getUrlParameter("rulesVerId");if(d==null||d==undefined||isNaN(d)){return}var a=document.location.href;a=a.substring((a.indexOf("://")+3),a.indexOf("/member/"));var c="http://"+a+"/static/xpath/v2/toolbar.html";jQuery.ajax({type:"GET",url:c,async:true,cache:true,success:function(v){jQuery("body").append(v);jQuery("#ncx_toolbar .save").attr("disabled",true);var l=newcrawler.getUrlParameter("webCrawlerId");var h=newcrawler.getUrlParameter("siteId");var s=newcrawler.getUrlParameter("rulesVerId");newcrawler.fieldArray[0]={};var p=null;if(l==null||l==undefined||isNaN(l)||h==null||h==undefined||isNaN(h)||s==null||s==undefined||isNaN(s)){}else{c="http://"+a+"/member/rules/query?webCrawlerId="+l+"&siteId="+h+"&rulesVerId="+s;jQuery.ajax({type:"GET",dataType:"json",url:c,async:false,success:function(i){p=i}});for(var q in p){if(isNaN(q)){continue}var t=p[q]["searchMode"];if(t!="xpath"){continue}var k=p[q]["id"];var g=p[q]["name"];var m=p[q]["selectExpress"];var w=p[q]["selectType"];var f=p[q]["labelType"];var r=m.split("/");var o=[];for(var n=1,u=r.length;n<u;n++){if(r[n]==""){continue}if(r[n].indexOf("*")===0){o.push("//"+r[n])}else{o.push("/");o.push(r[n])}}if(f=="2"){ncx_et_tool.createLabel(k,0,g,m,o,w,true)}else{ncx_et_tool.createLabel(k,newcrawler.index,g,m,o,w,false)}}}jQuery("#ncx_toolbar .save").click(function(){var H=[];for(var E in newcrawler.fieldArray){var A=newcrawler.fieldArray[E].id;var G=newcrawler.fieldArray[E].index;var y=newcrawler.fieldArray[E].name;var B=newcrawler.fieldArray[E].xpath;var I=newcrawler.fieldArray[E].selectType;if(y==null||y==""){continue}if(B==null||B==""){continue}var j="1";if(G==0){j="2"}H.push({id:A,name:y,selectExpress:B,selectType:I,labelType:j})}jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div class='loading'></div>");var z=newcrawler.getUrlParameter("webCrawlerId");var x=newcrawler.getUrlParameter("siteId");var F=newcrawler.getUrlParameter("rulesVerId");if(H!=null&&H.length>0){var C=JSON.stringify(H);c="http://"+a+"/member/rules/save";var D={webCrawlerId:z,siteId:x,rulesVerId:F,rulesJson:C,url:newcrawler_fetch_url};jQuery.ajax({type:"POST",data:D,url:c,async:true,success:function(J){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div>"+J+"</div>");if(z==null||z==undefined||isNaN(z)||x==null||x==undefined||isNaN(x)||F==null||F==undefined||isNaN(F)){}else{try{window.opener.refreshCrawlRules()}catch(i){console.log(i.description||i)}}}})}});newcrawler.toolbarEvent()}})},init:function(){newcrawler.after();newcrawler.event();try{newcrawler.loadToolbar()}catch(a){}},loadJs:function(e,c,a){var b=document.createElement("script");b.id=a;b.setAttribute("type","text/javascript");b.setAttribute("src",c);b.onload=b.onreadystatechange=e;var d=document.getElementsByTagName("head")[0];d.appendChild(b)},loadCss:function(e,b,a){var d=document.createElement("link");d.id=a;d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",b);d.onload=d.onreadystatechange=e;var c=document.getElementsByTagName("head")[0];c.appendChild(d)},message:function(d,c,g){var a=document.getElementById("ncx_message-box");if(!a){var b='<div id="ncx_message-box" style="background: #FFD76E; border: 1px solid #E1BA53; border-radius: 2px;padding: 5px 15px; font-size: 12px; font-color: #333; font-weight: bold; position: fixed!important; top: 10px; left: 50%; z-index: 2147483500; display: none;"></div>';var f=document.createElement("div");f.innerHTML=b;document.body.appendChild(f.firstChild);a=document.getElementById("ncx_message-box")}else{a.innerHTML="";a.style.display="none"}if(d=="show"){a.innerHTML=c;a.style.display="block";a.style.marginLeft=-((a.clientWidth)/2)+"px"}else{if(d=="fade"){a.innerHTML=c;a.style.display="block";a.style.marginLeft=-((a.clientWidth)/2)+"px";setTimeout("newcrawler.message('hide')",g)}else{if(d=="hide"){a.innerHTML="";a.style.display="none"}}}},initLoad:function(){if(typeof jQuery=="undefined"){newcrawler.loadJs(function(){newcrawler.loadCss(function(){document.getElementById("ncx_message-box").remove();jQuery("#ncx_message-box").css({"background-color":"#BCDFB7"});newcrawler.message("fade","Completed.",3000);newcrawler.init()},newcrawler_server_url+"static/xpath/mark.css?v2.3","mark-css");newcrawler.loadJs(function(){},newcrawler_server_url+"static/js/zeroclipboard-2.1.6/ZeroClipboard.min.js","mark-copy")},newcrawler_server_url+"static/js/jquery-1.7.min.js","mark-jquery")}else{newcrawler.loadCss(function(){document.getElementById("ncx_message-box").remove();jQuery("#ncx_message-box").css({"background-color":"#BCDFB7"});newcrawler.message("fade","Completed.",3000);newcrawler.init()},newcrawler_server_url+"static/xpath/mark.css?v2.3","mark-css");newcrawler.loadJs(function(){},newcrawler_server_url+"static/js/zeroclipboard-2.1.6/ZeroClipboard.min.js","mark-copy")}}};newcrawler.message("show","Loading...");if(document.readyState=="loaded"||document.readyState=="complete"){newcrawler.initLoad()}document.onload=document.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){newcrawler.initLoad()}};
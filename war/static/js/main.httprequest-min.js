function httpRequestFun(option){var httpRequest={fn:{init:function(){$("#"+obj.v.formId).find(".changeCookie").change(function(){obj.fn.changeCookie(this.value)});$("#"+obj.v.formId).find(".changeUserAgent").change(function(){$("#"+obj.v.formId).find("#userAgent").val(this.value)});$("#"+obj.v.formId).find(".loginTest").click(function(){obj.fn.loginTest()});$("#"+obj.v.formId).find(".loginCookie").click(function(){obj.fn.loginCookie()});$("#"+obj.v.formId).find(".create").click(function(){obj.fn.create()});$("#"+obj.v.formId).find(".remove").click(function(){obj.fn.remove()});$("#"+obj.v.formId).find(".update").click(function(){obj.fn.update()})},initSlider:function(v){$("#"+obj.v.formId).find("#timeoutSlider").slider({range:"min",min:1,max:20,value:v,slide:function(event,ui){$("#"+obj.v.formId).find("#timeout").val(ui.value)}});$("#"+obj.v.formId).find("#timeout").val($("#"+obj.v.formId).find("#timeoutSlider").slider("value"))},changeCookie:function(type){if(type=="1"){$("#"+obj.v.formId).find("#cookie1").css("display","block");$("#"+obj.v.formId).find("#cookie2").css("display","none")}else{if(type=="2"){$("#"+obj.v.formId).find("#cookie1").css("display","none");$("#"+obj.v.formId).find("#cookie2").css("display","block")}}},loginTest:function(){var userAgent=$("#"+obj.v.formId).find("#userAgent").val();var loginMethod=getRadio(obj.v.formId,"loginMethod");var loginURL=$("#"+obj.v.formId).find("#loginURL").val();var loginCode=$("#"+obj.v.formId).find("#loginCode").val();var loginCheck=getCheckbox(obj.v.formId,"loginCheck");var loginEncoding=$("#"+obj.v.formId).find("#loginEncoding").val();var loginHeaders=$("#"+obj.v.formId).find("#loginHeaders").val();var loginCodeURL=$("#"+obj.v.formId).find("#loginCodeURL").val();var loginURLParams=$("#"+obj.v.formId).find("#loginURLParams").val();$("#"+obj.v.formId).find("#message").text(nc.i18n("res.login.test"));jsonrpc.httpRequestService.loginTest(function(result,exception,profile){if(result){$("#"+obj.v.formId).find("#message").text(nc.i18n("res.login.test.success"))}else{$("#"+obj.v.formId).find("#message").text(nc.i18n("res.login.test.failure"))}},obj.v.webCrawlerId,userAgent,loginMethod,loginURL,loginCode,loginCheck,loginEncoding,loginHeaders,loginCodeURL,loginURLParams)},loginCookie:function(){var userAgent=$("#"+obj.v.formId).find("#userAgent").val();var loginMethod=getRadio(obj.v.formId,"loginMethod");var loginURL=$("#"+obj.v.formId).find("#loginURL").val();var loginEncoding=$("#"+obj.v.formId).find("#loginEncoding").val();var loginHeaders=$("#"+obj.v.formId).find("#loginHeaders").val();var loginURLParams=$("#"+obj.v.formId).find("#loginURLParams").val();$("#"+obj.v.formId).find("#message").text(nc.i18n("res.login.cookie.reading"));jsonrpc.httpRequestService.loginCookie(function(result,exception,profile){$("#"+obj.v.formId).find("#message").text(result)},obj.v.webCrawlerId,userAgent,loginMethod,loginURL,loginEncoding,loginHeaders,loginURLParams)},query:function(callback){moveAllTr(obj.v.tableId);queryLoading(obj.v.tableId);jsonrpc.httpRequestService.query(function(result,exception,profile){moveAllTr(obj.v.tableId);var data=result;data=eval(data);obj.v.jsonData=data;var key=""+obj.v.webCrawlerId;httpRequestMap.put(key,data);for(var i in data){if(isNaN(i)){continue}var id=data[i]["id"];var name=data[i]["name"];var cookieGetMethod=data[i]["cookieGetMethod"];var userAgent=data[i]["userAgent"];var method=data[i]["method"];var encoding=data[i]["encoding"];var timeout=data[i]["timeout"];var createDate=data[i]["createDate"];obj.fn.addRow(id,name,cookieGetMethod,userAgent,method,encoding,timeout,createDate)}$("#"+obj.v.tableId).find(".editHttpRequest").click(function(){obj.fn.edit($(this).val())});removeLoading($("#"+obj.v.formId));callback()},obj.v.webCrawlerId)},edit:function(id){var data=obj.v.jsonData;for(var i in data){if(isNaN(i)){continue}if(id!=data[i]["id"]){continue}var name=data[i]["name"];var userAgent=data[i]["userAgent"];var method=data[i]["method"];var encoding=data[i]["encoding"];var timeout=data[i]["timeout"];var headers=data[i]["headers"];$("#"+obj.v.formId).find("#id").val(id);$("#"+obj.v.formId).find("#name").val(name);$("#"+obj.v.formId).find("#userAgent").val(userAgent);$("#"+obj.v.formId).find("#encoding").val(encoding);$("#"+obj.v.formId).find("#headers").val(headers);selectRadio(obj.v.formId,"method",method);var cookieGetMethod=data[i]["cookieGetMethod"];$("#"+obj.v.formId).find("#cookieGetMethod").val(cookieGetMethod);if(cookieGetMethod!=null&&cookieGetMethod=="2"){this.changeCookie("2");var loginMethod=data[i]["loginMethod"];var loginURL=data[i]["loginURL"];var loginCode=data[i]["loginCode"];var loginCheck=data[i]["loginCheck"];var loginEncoding=data[i]["loginEncoding"];var loginHeaders=data[i]["loginHeaders"];var loginCodeURL=data[i]["loginCodeURL"];var loginURLParams=data[i]["loginURLParams"];$("#"+obj.v.formId).find("#loginURL").val(loginURL);$("#"+obj.v.formId).find("#loginCode").val(loginCode);$("#"+obj.v.formId).find("#loginEncoding").val(loginEncoding);$("#"+obj.v.formId).find("#loginHeaders").val(loginHeaders);$("#"+obj.v.formId).find("#loginCodeURL").val(loginCodeURL);$("#"+obj.v.formId).find("#loginURLParams").val(loginURLParams);selectRadio(obj.v.formId,"loginMethod",loginMethod);selectCheckbox(obj.v.formId,"loginCheck",loginCheck)}else{this.changeCookie("1");var cookie=data[i]["cookie"];$("#"+obj.v.formId).find("#cookie").val(cookie)}obj.fn.initSlider(timeout);return}},create:function(){var name=$("#"+obj.v.formId).find("#name").val();var userAgent=$("#"+obj.v.formId).find("#userAgent").val();var method=getRadio(obj.v.formId,"method");var encoding=$("#"+obj.v.formId).find("#encoding").val();var timeout=$("#"+obj.v.formId).find("#timeout").val();var headers=$("#"+obj.v.formId).find("#headers").val();var cookie=$("#"+obj.v.formId).find("#cookie").val();var cookieGetMethod=$("#"+obj.v.formId).find("#cookieGetMethod").val();var loginMethod=getRadio(obj.v.formId,"loginMethod");var loginURL=$("#"+obj.v.formId).find("#loginURL").val();var loginCode=$("#"+obj.v.formId).find("#loginCode").val();var loginCheck=getCheckbox(obj.v.formId,"loginCheck");var loginEncoding=$("#"+obj.v.formId).find("#loginEncoding").val();var loginHeaders=$("#"+obj.v.formId).find("#loginHeaders").val();var loginCodeURL=$("#"+obj.v.formId).find("#loginCodeURL").val();var loginURLParams=$("#"+obj.v.formId).find("#loginURLParams").val();showLoading($("#"+obj.v.formId));jsonrpc.httpRequestService.create(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var id=result;if(!isNum(id)){showInfo(nc.i18n("res.create.failure"));return}showInfo(nc.i18n("res.create.success"));obj.fn.query();updateSelect(id,name,"httpRequestId")},obj.v.webCrawlerId,name,cookie,userAgent,method,encoding,timeout,cookieGetMethod,loginMethod,loginURL,loginCode,loginCheck,loginEncoding,headers,loginHeaders,loginCodeURL,loginURLParams)},update:function(){var id=$("#"+obj.v.formId).find("#id").val();if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return}var name=$("#"+obj.v.formId).find("#name").val();var cookie=$("#"+obj.v.formId).find("#cookie").val();var userAgent=$("#"+obj.v.formId).find("#userAgent").val();var method=getRadio(obj.v.formId,"method");var encoding=$("#"+obj.v.formId).find("#encoding").val();var timeout=$("#"+obj.v.formId).find("#timeout").val();var headers=$("#"+obj.v.formId).find("#headers").val();var cookieGetMethod=$("#"+obj.v.formId).find("#cookieGetMethod").val();var loginMethod=getRadio(obj.v.formId,"loginMethod");var loginURL=$("#"+obj.v.formId).find("#loginURL").val();var loginCode=$("#"+obj.v.formId).find("#loginCode").val();var loginCheck=getCheckbox(obj.v.formId,"loginCheck");var loginEncoding=$("#"+obj.v.formId).find("#loginEncoding").val();var loginHeaders=$("#"+obj.v.formId).find("#loginHeaders").val();var loginCodeURL=$("#"+obj.v.formId).find("#loginCodeURL").val();var loginURLParams=$("#"+obj.v.formId).find("#loginURLParams").val();showLoading($("#"+obj.v.formId));jsonrpc.httpRequestService.update(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}id=result;if(!isNum(id)){showInfo(nc.i18n("res.update.failure"));return}showInfo(nc.i18n("res.update.success"));obj.fn.query();updateSelect(id,name,"httpRequestId")},obj.v.webCrawlerId,id,name,cookie,userAgent,method,encoding,timeout,cookieGetMethod,loginMethod,loginURL,loginCode,loginCheck,loginEncoding,headers,loginHeaders,loginCodeURL,loginURLParams)},remove:function(){var id=getRadio(obj.v.formId,"httpRequestList");if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return false}if(!confirm(nc.i18n("res.remove.confirm"))){return}showLoading($("#"+obj.v.formId));jsonrpc.httpRequestService.remove(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var msg=result;if(msg){showInfo(nc.i18n("res.remove.success"));obj.fn.query();removeSelect(id,"httpRequestId");return}showInfo(nc.i18n("res.remove.failure"))},obj.v.webCrawlerId,id)},addRow:function(id,name,cookieGetMethod,userAgent,method,encoding,timeout,createDate){timeout=(timeout==null?"":timeout);cookieGetMethod=(cookieGetMethod==null?"1":cookieGetMethod);var cookieGetMethodDesc=getSelectText(obj.v.formId,"cookieGetMethod",cookieGetMethod);var newTr="<tr class='simplehighlight'>";newTr+='<td nowrap>&nbsp;<input type="radio" name="httpRequestList" id="httpRequestList" value="'+id+'" class="editHttpRequest"/></td>';newTr+="<td nowrap>&nbsp;&nbsp;&nbsp;"+name+"</td>";newTr+="<td nowrap>"+method+"</td>";newTr+="<td nowrap>"+encoding+"</td>";newTr+="<td nowrap>"+timeout+"</td>";newTr+="<td nowrap>"+createDate+"</td>";newTr+="</tr>";$(newTr).appendTo("#"+obj.v.tableId);$("#"+obj.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+obj.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+obj.v.tableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})}}};var obj=this;obj.fn=httpRequest.fn;obj.v=option}var httpRequest=new httpRequestFun();